workflows:
  dev:
    name: Dev
    instance_type: mac_pro
    max_build_duration: 120
    environment:
      vars:
        GIT_COMMIT_COUNT: '1'
        FCI_KEYSTORE_PATH: /tmp/keystore.keystore
        FCI_KEYSTORE: Encrypted(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)
        FCI_KEYSTORE_PASSWORD: Encrypted(UGdseEAyMDIz)
        FCI_KEY_PASSWORD: Encrypted(UGdseEAyMDIz)
        FCI_KEY_ALIAS: Encrypted(dHJhbnNpdA==)
        APP_STORE_CONNECT_ISSUER_ID: 69a6de82-0d8b-47e3-e053-5b8c7c11a4d1
        APP_STORE_CONNECT_KEY_IDENTIFIER: 9H3T4F5LSU
        APP_STORE_CONNECT_PRIVATE_KEY: Encrypted(Z0FBQUFBQmhVallHUy1TaVBwcnVzWkwwbk9lb0FhUm0yOGZCa3pKVkpaWXgxYzRIdHBDQlVNUlVNNm9BQ2U3T0x3dU1hNWV6SklPNDBVeUJfYVNnTFREeHpneUJ2Z2dSRzl6WUxySUN0aU5aOGpYR3VRMURXcnRTX2JEMUgwUWtyc0U4WmlDRy1aa0dKanZ3alZWXy0wU1lVMHZsY25rdmxIbmIzXzRCMmdOT0dPTjRENnVKTUFpZDhERU5WXzZXem56MlMzQnp2Yy1fQmZFcTNYNjNFTl9aU0xhOXFGUVA4YTdZWmwtbHhGMFFZcWtpWGk1ZzNuQ2UtNHBDcFAzQTE0dU9uRHFhMDZQaEpkZjdvMnhpMWJyWnpTeTNfeWRGd1pnTmhkdVhuWjFFT2VPVEhfeURLeXFVWHROQjRkQzZfeGgtS2lJbUFMc21rRzh6Mm9SVWhrRmlkLWd3X0luME1KeGVOc3JIbnAzRF9xNUp4VmtMOHJXTTVLalVOWjNpZDA0V2dlMW50NDVqSF83U2pKNUNXVTRPVWRrWVkzRktwZV9CSXl2V0M5UjlEWkpGWWVfOVdlRT0=)
        CERTIFICATE_PRIVATE_KEY: Encrypted(Z0FBQUFBQmhVallHNEMtZmZjTEo0aFNRczRsWnNtSjRjZ3pKbzRhcEFXU2dFMGJNZUNnaWRIdUllMHVKWEk2X1RrSFg1UFRfMXU0WDc3ekNHWmM1SnpJUkR6Y0d4UDc5X1lzUUdSLXd0WGlNVXlUS0ZXVWdDYWNERXBrd09yN1ZQMXVhTV9UQlM2bTlFZk5kRnA2WnJaWVRLQ3lpaDFHTkItQmNNZXR3QTNfbS1MWjlBbjc0Q0dabHFlVkZZWlVsRkVaUlNLQ052ZXNDaTVacDR0Q244eFItQXhTRzVlZVhFeEJxckhvdzFfTmZuZ2Z4UnBpTUdBcXRWdlpvV1VXMDM1ZTR1NlVoTGhqRHczNElWUmlqNXl0clFxTzZiMFl1Sk14bVVPVVZNTHhYVUw4Vl9ybUF3bXZvVS1YSlNrRENhUG95bmlGYkdiRGY1UUpfdWhPc2RXVzJFRDhPRUdSQWJybUxFc0RLVmkybnFacENwQ2N6T3hDU1g3N1NQVFlJRFNUSE9wUkg2OGdybUF0ZHZXYkxhaWFmdjZRRHBocksyZjBEb3JXdFlGbXI5ZUw4N1Z3dkxTaHh2MW9wejVRc0NMWlNIc2NpcUNCMUh4OHd3WkxieDRiZ08xUGFWMjJwQUl3OUJQSjVmOUJRM09nOUNoTHZUMW1heFRJZjJKMjc1ZWc1TU1nX3ZIZmhJSS1lSU5CajRjUWh4QXFMTWNPbTdKa2p0TjNDWkdTTUYyRFhFRWY2RFE3OVktVTZ2dmlrZU50Mmkxcm9icDBZN0tvN3N0WC1LOHlhQ0hBUjZUUVExa2xOcGpBWHRPZy04S3hmTFZpMk0yeU8xQWo5QVA5RUZXUzljS0Q3Rm9pY2dMMk5CeTlwOGFERTNwcUtqdW9TZjkzZzhoYTZOSlFrT1huUC1OMktyRVllYmNvc01oblZwaFFqR1Q4ai0tc0dYeGFCS2t3eVhZc2VLV2plZks2Q05mTXRzZGJzc1FwLTYzTmFHV3ZxX2ZIZVQ4d1Q3a1lDUDMyMWZGVGVVVWFXQ1RMOElwNkVFWFd6TXVnOEFnNjBTSk9DeDRGRE1WejJzRnVkZEpoZFBwVGNVRGo5N0dYMmU5SGwtenhmWTZVczFhMTZpT0ZjbURYa3lqdDBjV2g4QV93RVhoRS1KYTZZUXNuWnNVdDJOeFVNSzJmSzdsQ1ppUDhwTEUtZlNwczVYM2FqOUR2R1hyeFNxV01PRndTTGhKVl9uTGNWMXBXcG45bVRoU0Y3M0RrTGhhR3lMZTN6aDdrMklyRjZ0OXljallHanNLYWd0VXEybHdEZFRidFhkNklhQjh6andfallsZUVlX21fRWt6dml2UWlJYmxpODAzWHhvSnZHSmgzeWZnZTVJZkU5WFVIcFZBeF9VRWUtcWVWcEpZMkN3YUlfM09kSEl4ZHo1OGU2NVZnQ0dIV3RXSnZyWlNhcDZzeW5lNUlydk9VOFJ2bmEzdndYZmRwa2V1akNzeGxsNEs3RG13WjVsV0d1bXF3ajI1Q3hwSHQ3Rmh6aXpSNVg1LWVJZDRjQXZjb2tUcEFBT1FhR0RqWFdmeHhZOHNWS0xvOWE0TzI4R1Y2dnkyNFlldTNqZFdwa2M1d2NjZ0Qxa3NHWm5yM3FNaU1OY1ZCZklDS1o4UHRFZ0xXTEV6bVNIN0RUWENRMlN5TGw0b2dJVkpjRHBTTmlINXdHYnhOdGtVeU8yNnVnZnZYSk54eVRRRVZuaHM5XzlHeXBzY3AxQ2tjS2JXQ1A4LVJHeGZuMkRmSTVhMXJSdlZKcTVXam1oRFBUU0lxRWRkV3NVQ190U29Jbk9FYUhIUEROVVM5bUhabnlhZVNmZkFXanliQm5IajNZMkR5VlJ2Q3ZNc2puMnc2Y182LXM1NlplNEhTNklwdFJwb0JwaEtkWkJ5NVV4cVpNSi1lNThJNlU2dW1WZUFvM0U3LUVreUVWMF9pVERncnJ5VzFPb3p2Z3pVLTBLOHF6Ny1XTFRvZTBYU1h2aTFTbnlUWHE5eDVGWS1hODZJb0oxelFOVXpvMm9kT0VrRnptU3laQTBkUVI2TG9Pc1RqdlAxNWpXRmdQMHZjN3JIcDlhMG5OZWtoS05ZMHk5Y2NyVzBiNzFVX0VWMFJEbW5PMUlCLWdna2lQTXZTb3lxTzlvM2xOaXVjSDJBeDVla3U4Vjhpejg2T3R5QllOdklKd3diRTVORExxRGlMNWZXajE2a09ueW8xRXV6d2lWcUY0Sk00WDR3clJkZ2lhX3pfcjFHOUNlYmZySFV4dmU3WWl1RVZFdFp5MDMwc2xHN3JOWGdQOG00VnJFRXptWGtLZUpZMURIRGdTT1FZR3F0X0NLOXpKY0dvM1hkLWl3clBlLXFSb1R2bjR6REMwQjlJa05WTzJaZkN1N2VPWkJTVlFWOTNISzJJUW9ELVNIOEV6blFQZ0xEc3B4N200QktvVmZKaHJKQVN3LVBZWGU3cEhFeGctTE4zR0FTUVVlUUszd04zYnBiUmxjTFdRUjRzdzVjN1o4ZjdhY1g2dTB3bHA4VkhiOFRqTS1PdnRFWTBYLWRGN01mLW1wUlU0SzRyMzVDY2NyR2VnOUxtbmVIaHRHVmNBUVRWUDg5ZlpFbk00Zjc4RnJGSFlTa1JoSjJOOWg3RDg3M3JBRGpJeWhiU3JqRC10VFBxNk9mQXJzb2kwNU4tUy0zT0Z5R0RFSG5ISTY0Zlc1OEFaMG5TbVdrdUhLanU0bk44SDZFUU1BbFViNFR0REFwVjQwTUtUb3o5RVEtMm5yNlY3SVNFcTl4RkMxcUZ6R3lmck9LaVpPY1ZJQlp0VWFJS3Q3RGVjUUc3VkhKTWhId1RCUE5sYmNWZTdNVnFFTlRMLTRqMGRyenhTWnNLb0lSZDhnQndBV2w2X01McEFDbVFlWExLaE03TGtfNjA4TWtsQmg1TGJnTEZmOGU2U2luYnVvMlMzai1ERjJFQlh4Q3RGVno2Znhfa3VsR3lZMGk2ZWdGLXQ2bWt4Ul9JaERIUGxuWXFoeFhaRm1ROVZrRlZvZUVVUUlhWEp1bHNGa3FIRWJ1emZrN3dh)
      flutter: 3.16.7
      xcode: 14.2
      java: 17
      cocoapods: default
    scripts:
      - |
        # set up key.properties
        echo $FCI_KEYSTORE | base64 --decode > $FCI_KEYSTORE_PATH
        cat >> "$FCI_BUILD_DIR/android/key.properties" <<EOF
        storePassword=$FCI_KEYSTORE_PASSWORD
        keyPassword=$FCI_KEY_PASSWORD
        keyAlias=$FCI_KEY_ALIAS
        storeFile=/tmp/keystore.keystore
        EOF
      - |
        # set up local properties
        echo "flutter.sdk=$HOME/programs/flutter" > "$FCI_BUILD_DIR/android/local.properties"
      - |
        cd ..
        git clone --single-branch --branch task/dart3 https://bitbucket.org/mtminc/mbl-flutter-packages.git
      - flutter packages pub get
      - flutter build apk --release --flavor dev -t lib/main_dev.dart --build-number
        $PROJECT_BUILD_NUMBER
      - find . -name "Podfile" -execdir pod install \;
      - keychain initialize
      - app-store-connect fetch-signing-files "net.mtmlink.member.dev" --type IOS_APP_DEVELOPMENT
        --create
      - keychain add-certificates
      - flutter build ios --release --flavor dev -t lib/main_dev.dart --build-number
        $PROJECT_BUILD_NUMBER --no-codesign
      - xcode-project use-profiles
      - xcode-project build-ipa --workspace "ios/Runner.xcworkspace" --scheme "dev"
    artifacts:
      - build/**/outputs/apk/**/*.apk
      - build/**/outputs/bundle/**/*.aab
      - build/**/outputs/**/mapping.txt
      - build/ios/ipa/*.ipa
      - /tmp/xcodebuild_logs/*.log
      - flutter_drive.log
    publishing:
      email:
        recipients:
          -  psonawane@mtm-inc.net
  qa:
    name: QA
    instance_type: mac_pro
    max_build_duration: 60
    environment:
      vars:
        FCI_KEYSTORE_PATH: /tmp/keystore.keystore
        FCI_KEYSTORE: Encrypted(Z0FBQUFBQmhVallHY0Z3dTVJdEV4eXBfMWpING9SMjd6RmwzcTJYSUJlcFEzMnNfT0p6RDA0NUZaSlJsckJhN0Riczd3dWhjR29EQjVCaHZQSFkxTWxWV3daLVV1eElndlZkeDdsV0toU0ZOYlBYMnFDSmFnaDgxYlZOaEt4UmJMNTNsclNWRjA2dmZRdkFKOU5vamxFYVFHOTdxUENUWGExSnhaTDRZcDc4NEtteHB6c1RnZEJDbXJOb3draUJRRWgzUmgtWk5DU0YtYmpGZFNwM2pPdHJPS1Q3WTQxZGJsNTRBYW5xRDE0MHN4dWxGVl90S1htN1VaWnlUZEJ1b2NRbXFzWlpuVXpXSXloYi1KYUNfbDFRSkRhVmd0Smo1c200LWhDSWRSaTlIUHE2OU9qbXlORkFYeXVVcmc5eDFpUUd6Y2FrYy12aS1lWjgyaUlUSjlMaW1NTlUtRFl1OHZIV2d2cjRuNjNpc19rWFhYNU5XRTVIQzR3dzc2bTZ1S0F2TVdiQ2RRaEFPcjBXYkNlX1FUWXVTS1k3c0tKS0FBSVc5YWpvX0x4c0pqcVVSQUpwV0JZTkNJTGQzblhOa0NFZUtXZDk4Zkh2Q01QWkx2a1ZfY2ZmcWY5VllSZGRZMnlqVHZydWJJMDhzYUlpYURtZWgzTHMtUW5rMHBaZTYzcVRDQXFYbTdRZE5BU0MzeDNkcHIxV05ldURHSVBaWUF0RFN3RGZPZGRzUmY0SXkzcjFPWHVvdVdVNnhUdXFKWXJwaTBfZWk2XzNic0FjUUtaTXk5dWVpdk5URDJxbXM2dUZsWEMwUXVjNW1WdGI0ZElBT0xoeDRuRnFVaHY5dHlNX0drNDNZb1lBYTREVjJseEQzNnFOSExtWGtudU5ENnN1WUtmRzJYTDlER1JfV3ZvMVN4d3AyX19yZnBOeWx3am4td2dKTnpsLUZ0bWpxS0ZQbGpQbTBYSWw5QUwyR3dxcmFRTDVQTEs4aEFtS0kyQ0RxVHV2UDVqWHlGMzJybHRlemJiSWxzZS1JcWZfRnEzWDV2TlRxTVczTGM0dk1FckI4bnZxd0ZYcEpRVFgzaUxBd3VaNWhQc3lwSFhFdUR2NFVESXF3Y01zMWJuYmpzTHpQUFp2SldmWC12QjZlMEtnT2dOWWZLZ0RJRy0zeWdfdEVlQkdkT203QXFOWUVxcnpCQm1KblNXaFRvcUlUSG4wcWdkN1o4b3hvd0RuaWoydEZtUGNmNWt4V29SNk9CWWE2eW9HV0dJUFEzb3NVWENlLWNkbW4yYVZWX2JqcEl4emlRdmgtQVVvUEN0WTVqd21GUTVmQ01WOG5QSS1tWmZ6bjlFRGNlZjQ0YUtPUWpPVk9kSUhRaUlBa1Z2aG1falBCTXR4RmJ0QUxodVg3ZFpNZnhoRHYxV0ptLWdHWEctVVlUb1VjNFJ6TlhpbHFmSGZsTmlhY0EycFpON0lzX3I0cEl3QVZNVktjV0xLZDBtN2tHT2p2WWtTQmg2X0FmYldmQkdBZmk5RnlEekw5OTV5ZjV0MVFOTEZwLWVleWJKakpvczFFSWw4emhTYkpuOENRNUpQcEthNnd0ejY2MmQyeVZ2bGdmbnRMelNVc01DLTIxUl82VnVEMHZrcldUYk9yUG1CNmNKYk1qOGE3T3VpNFRFSUdfMHJMWGhSdWFDaTJTc1dvVUphZ25RNzNCRmZVNDFFVm9JZUhrTFk3S2pHQ25iZmZObkEyb0Q5V1RnZlhwc1RLVE9ZNmRxYUR4N1dzblRaR3V1Q241RGQ2NVdxbUstTDc5MUtCUEx5OThNZFFwVmt4WWpsTDFqQ0ViS2xyTzBmR210bjJBZkNtVDYycEU0SzU5NVVRblNlY0EzVVA5WFdNMkJ1MC1rMUxGVlVsSWZKS3g4ZkZRZ3hORWU5amdEbnpTSFpuVHBSWGlHenljTXFCTTJfYU50VXAyVkZsUVFKWVg0bV9ueENWa2tLWHdZQldrckFIdU4yUHRNRjJsaGtzWHgzY042Y0JhZS00cy1qSFRLallZcHpWb3I0cEVTeGVmZFJ1blFTczgtUUdpY28tUFVoZ0h3dmpRM3JMaEpZVzhpeGduelBhc3pwVU9kOGZzWkJYQ0tlTDFFTVVyWDZPTWdYNVlta3FHM0xiVWItRFVOUnFpNnRValk0QWg0S200am4waXhpcks5UXFjdDRBMVNQbFV2NmV0Nmk3cnJsdUNvQjNfS05maUgtWUdRN0h2UWVPLUxhbHh1eEhIbXhSSWRITXl5V2hfWUJkTTI3U1pBOHRNX1hraHo5Vnp4LWNqQ0NwbFU1OTM0c2FNM0NZWngweHhCVnk2MzRHbXZDMHdhQmtTTEU2aVVpMmQwN1RSVXdGOGVOM1NwMG5kWWFtZWNzNGdJeXFfLTFJeUFLUWdmbk94U1JmdFZBSHlFcFFYMGNnZUh3QVBmS1FQY05CY0RjZ1Q1Qmk3SHR2WlpGTWtMS0lHbmMtRW5tZ2xDUWkwT1F1TDBRQWo1MFdyWXhmRXJLV3R3MDg5cEo0UGZmQ2tvNVgyYU4wcW9GeVpUNng3SXRIQ214ZklpaEYtd2RBSENBc1k2X21pTlVUOU8yUXF3VFNIam96bUZqSXBNWV9za1kxQjdPVkU0NmZZY3JpaXlzTlMyeHcxaVIwTUVad1MycUJRUDJ1ZGl5N1liQzdKYlJIQlE1VW93WUp1SzV6SnIwNjZ4NHpmYkNZbVBmOTlpLWVzWHZKTDFkLXlmMmpON0hMX2x6U0Y5ZlZvT09kZVVERzFLZFRYODVUbE0xd29NbkZDWlVHSFhxQmRkcnpGaWJOVEk2Vkg5ejlDb19DRFg0N3dkWm9acWVtcmM5YnpGNGhrOVNadGZPazctQkYxTGlONXNSNVlMbE9iUDZEU09HNUROSG1JTTlCcUgzUmxRVUNfSlVEcHc3dzBOeldSYWFBQjNxRmRqZUY1cWV4dWtLb1Rvc0YyQS1qZm9kbThuRFJ0Q0ZWelNXM2lZRkRZOVFtMFViSkpyaFp0X1NMUzl3NjA3dVk2U1JvVC1EUTduS0ZZSjFzcE9wSDlDVUtKMF9BOWJkNmxzZ2NKZ0l3am9scHJraWp4SzB5QWo1NmFMZlFKT3V6bzN2YTc0TWMxcy1sUlVUaG5tS1pCRmh2Wm9Eb1J3TVZiRWZPVUUyN2g4U0xjTWFPQlNlTkY4R1JsS1hDQlp1ZjFoSEptYUxlaDRMektHd0d4eXBxYlJ6YjhTYUpKbTZFVUxHOWtxd2hOeVVuZ1ZCTjhqYTFLTVdYN1VKTFhnRENobktndnZjVkstNUF0cUxFWEdSSGRnUzdyQzVMTnY3WE5mRWM1WER5NG95V0wwTTQwank1Ty1iemVuaDVTRUFTbFlXQ3Vrb2lTNFNvMks2dm1IOS1yUmZ6SmFNUW95Vk83WDVEUklaRDIza0dKb0xpWUV0RUh2V045bTlabDhCbDlmcXM2RkRyMFdKZ0hOLTJ4WjlWNVBUY2hiRW4xbENXbV9sMmc3bmlJZ1I5ZHRjZDhDa3lSWXhaZFJsX1EydE13a20xdWdUV0VqU29teVowM0QwTWl0TkpzMzU0Ukp4ZXpTelVoRnl5dXg2cU8zQ3hKdW1uRkFzNWdNQ1hPSS0tYWFUUVpyU0VtUHp2YnI5c3dXYnFaOUlfWndpblE1NkFRN2dnTFpfSzNxOWxjRUhvMnNMWlJJb05ZM2tOanhvd1htQWJXY2hqWlYxSzJsZi04akotVkVKYUgyREFocFdXSkRiWVdaYTlYSGNOZ3R2ckdxRVlTQ24tN3h2cWZPMmFjdldPT21TM3ZGVUZYX09IN05YVXdITVRUSHZVa2Z4T0dxakpuaHRTM1pYN3NQSWhmNVVxd0VDcVhMa0F1VlNnSUo2ZGY1RWJsNXl0UWNjVktOQWx4SUtDWm9kY3drdUhMbnY1cHplRkdLdFJNdzBNMnQ5c1IyZ3NubWF6OEFVOHlDaG1rZnlxUFhtbDFBcjRibmp5QmtEc291ckFTYUUxbjRISUpaaW1FbmVKUVA0Q1pKclkwTnRVRjFwY1dGU0EwSDFVdTIxNnRNV0VheHFxWE1SeDFaWGhDUEtHMWxLZWtLdjV6Sm5nbzE0dzJCVkVmYjJ6SXl1emNGeUlPYjBXdmZaWUFvTDdqUXFCVVJRM1E4TENsdVdFaWJkS25Ya042Ymk4c2xmR3FVZFBSMzFJcXBXRmlsamx1WlBVQ2lNRWxaWnlON0xWRFF4TXFTZXFuNXdVanBtSzNGb2xUc2lqM1pBZHlKaE5XQjdfY2gzM0dCRTVzTzRJTG9GQkhUQU9fYlBBZkZyX0xZM0lzYTczaDBMMzNBbzZYeDFoMHIybGVVUW5MRFlyRC13NmxRTTMzSjhPNGJTMDd1WkNaSTNod1RORVJoLW44dHdJTDFiTTJvaVZLRnpYY3dobmRoTEowQ0RSUUJKbmJDbW0zOG5Kc3hhWm1ZQ0N2ZHRwcVpmT2lzYmhGNkdIQWtYRHE3V1hjdHRoaWJwX2R3S3BMNWxpaXBaZHl6cnIyTjJST2RlYmhSemE5WGprMkcwbjNzcV94RkJuc3ZaTmhHZ3ozQVZGWVJQbFpuZ2xpeUJIVjVjaFc5NmdUcXU2a0habGd4MEVCTDJwZmE1YWZWQnVyaGdtT1RkSzRIVXAwTXctZ0loS2Z0RzRZQm42V2xGN09wQjNtQm9FSHE0Z3VhR2lqUng3WFotS1NtMW9UVjRfRlROTzVRYkh2cGlLakFmWXRIbGdnQW5OejA0NldZMEpfSTcyS3Q2VnBUVTdhUXNzVVYzQVJZNGNkYk83SjRjWVJOMVNOWERpdVJ3RGtLTUNOcFZEVEY5QXI4TWpnT0xRUkU0dFIzT2duLVJyc1JHaWFZZ2tDM3ZsWXBkOFVWY2pOUGFieVhVbWdhZE5uM0UwZnh0bEdtUmU2NzRRb1RuMjB1S2F2YUpXY05Vc1NJR2NDN2J3enVKSnRyczdpRlFKLW13Mkk0N1NIOEN2c0JKeGgxaHU4N3UtWjQySkVHb0NVUjJvRk5KLXgzMmN3LU1PTnZ3Z3lGWHdfampHNXZHdlVsYlJScHVzV2FyQk12YlVtWGZkdC1CZFBGQ0lfRnRBQXdFSTI0cFNCSDFRbi16SDVUY09VTWNhVld1cm9HemtWWFNzTlF4cC00eGtFN3doNDJIUlVaOTRiR0FLcXQ1Q2hFeUtIR2xQT1VFUGtTZnFjMENWelRFUmYyblJhY1hNby16SGtMWHJBX1RmYnphZHNFRDdnNmhGa3VITmZseU5DUzJZcTJtZmV6WWFWUW10bDE3cDU2TXZBNmVIVFVteC1fanh4ODZOU1pxZzhpT2d3cHlGMGowNFdRbGpuMU9fa0RfdTRfWF9Nd2J3UVVXRVctQ1B6a1hCcW5LeEhCejVZUE5KeUpPaHdBX3VLSDRjc2NyblZaWEdvcnJUQkRjQVFpR0lFdzR3aGwzdUd3QXg3aGpXYXN0Q3FGdWtHM2thbkdjaHpBdkdXTWNFb0ZTSDFxRmZrdm1McUJSQ3VtbVJuMjVQVzdUOXdHcEFTOGdQcWVHLXBkWUxHTmpGa0Zkd0JBN3RkZWlVZ0UtSXp2QlZsaWUyUlR6bWM4M3VINVAwUmVCS3RlbVVLd21KUlYzUVh5VkZjVWF0R0lKNFo2TmtCUkVPWFBtcDNKMzRDRHE5V2xhYV9WU1VtSkZLRG9BRGlORGF1VHhyU01FbEhDeXZhQmRXQkx3enB0akNCMHh2eXVzNkF1ajB3dVNiOXpGeHdxQnVBZG1IVFg5Njl3M3NRaUdxd2VXb2Q0bEFyak16NlJPNXNLN0p5OFRYQm1Qc0o1cEdEbVB4b2x0ZU83UlcwTVBxWEozeHpGYnkycVdxd0N2WGJGdVBsMWNlZ2FhdGc3WGVjY2UxVWhsT2lOYlVXN2JiUW1oSEtUOGJraHRyblJsNFA5SlQxcGp3UkkyOHdRbWhnT2pKMlR1MEJoV2NoQmp5ZEJUOHBzM2pseHY0ZG9BREs3R0ptekZ1OG9oYXptdFFlRFdiM1JHeGhPbFYwTzB3akV1RjZvblFLdXVVYmNQcldUUVh1SFFpQThLMWo1YlI5NC0ybjRLT2gwTDh2NjFFLWkxUUhVUUlWeWJGRWcyRXJzM0E1eU1OMXdRU0hpYjZ5Q3FscGJuR01vZlo5ZkN6dGFHMHZOND0=)
        FCI_KEYSTORE_PASSWORD: Encrypted(Z0FBQUFBQmhVallHMklzRjRTcFdMTlRwajdlTGtpQU9vVTExdnlZaU50aWxnQU1MbTF1ZmNTX0RMSWlldWNuT0FGS00xQ0Q0QzNyckV4QTRsSXFweXYtR1JXWXBkUU5UaWp4QjJyU1ZDb24yRHluQ3NDQVJ4RHM9)
        FCI_KEY_PASSWORD: Encrypted(Z0FBQUFBQmhVallHSDVpUUJuYjlyTHlpbWJOZUdYOFR5cmhxMXFTd05ma3AwTndlWVpmYjQ0R3VhdGZKU3RjVVBCVlc2aU5oWFl2QmZXWHVMZ2FlMzBxOWdNNHJTak5wVUZuY21STVNqTUxkcVNPNWpmLW9ZM289)
        FCI_KEY_ALIAS: Encrypted(Z0FBQUFBQmhVallHazd3MnFydC1UcWFaOVN4SmdpMDVZSEE0ZWFmS2J2R1N0WEtKVXkyYkNfY05YYkZlY3pwY0hQX3RDdmlMSUdUZ0tSRmRFNXg0bV9UVEFGbTlXWGJDQlE9PQ==)
        APP_STORE_CONNECT_ISSUER_ID: 69a6de82-0d8b-47e3-e053-5b8c7c11a4d1
        APP_STORE_CONNECT_KEY_IDENTIFIER: 9H3T4F5LSU
        APP_STORE_CONNECT_PRIVATE_KEY: Encrypted(Z0FBQUFBQmhVallHa1dsdEp5OHpVa0h2TzdfWVVLbjFUaUt6eWpJVFpIdks3T1BPWHk3OE0zc2JKcW9QMHRqakhIQ2VDa2lQcWpneENoYnBNcHJ2bUEyS0ZwVG9IRy1GQ2hNdGtvbTBUOGRhRkJPYXVkTDZZM3pvQlZ0ZnZwa3pUcnNEUXotMS1lbXhEbV9iMUZHVkVVNVRIYXM0VFE4dUZLeGh6Vkd4OFBnU05iNlp1TUJNNlAxSDE1endwSk5TMmlRbEFJZHBiUUJLYW9abzZhaXNYX0JqaGhkdlZkUmhiVHlZR3ZtOExWV2JXc3V4VnVnYll2R3BRbGlyZm1NVXBWNmJ2RW5mRkNmTkpOX0tFWnE5VFltczlLNjkwM2xmT3hPbVVheWxvRnFUUGg3Unl1LUY0cVFlcWh5ZFBvQ2w0UmJHM2xuNmFGYk52QWMwdGFEU2VvcWdBZzliRWlCVUI5V2pRRGZsVWZSazB3YTUwZ0JWMm41X2xRVFNudk9Jb1VCekhuUWZzX3VwLTlnWk9QUDc0ejFNOVYzV1RzNEt2R2lnTEEwaWFfY1JNbVg4eS1pbmxPQT0=)
        CERTIFICATE_PRIVATE_KEY: Encrypted(Z0FBQUFBQmhVallHeFpoN1ljZ1VJbVZ3V1lhZmZxREM1Q1RsR3Z1Nl95V0VxcmxqLTZkREpJTXZOYWVvb284RWNmUHRTRG5GQXJTNGc0M0Z2RnNkUVVpZVdUNHota25DaWNEOGlQVG5mbWkwR253UWNHQ0ZTS3VMTU9wUnhTUGYteHB1RkZFdVpsNUxGUVZUeFp4ak5QVUZoU1BrZ19UY2pwS3ZfclowNmhnbGZ2TzRCTkNwckVtQU9mLWd4QnpUV2h1QW9uUi1OTEZ4blRyUTljcHFVMGMwd0c4S2xWdG5IYUZ6ZmpmV1lTYjhfN2hGSW55cVZrSnR6Y0h4TVBBREtrYXRlZ1BLRmg3Unprbm41UHQ1TXZYcjdNU3hSb1JKTXdBYnZWZlJCQzFoOVR1WXRXZ2o2LUZabWdMcWJjMVFUS1BuNHdnMTNiVWY1alpJVDRSOFdxUGxDR3czVVNOM0RiTGtBMndRRDFVNm9fejhPbU1qRDhVX0VfOVpvWV9qa3p0ZVc5WDFsZWR2WGFjcjVZSkdsSXBSRmp2X28tODllZmlsTVpKbE1ybFlfUnpxRWNkTE14ejZXT3dzelB3SGdad21tZS1iZUFvWVpFa25kOS1vQmREUl9fRm1haVhDQjkzN09xVlN1QmYwdFZ1OHFaSS1oVWtTaXlRLU1jdVIyOWZsaGxnTHA4QVc1X05VYmFteVJYR0Ixdnh4eVVyVGZQZGtnck1VcC1GRWREQnQwQWtkdXVrYXdrcEE2YlA4N3RhWHZ1LV9KNDU3QmNXZC1rSVl5MmJHNURKeTZQR25BV2trNWx5Z3pqV3pDb1hmLWpkbWxqaERycno4LTE3cXF0NHFucVlMMEJLUkpsX3NmaEx3ZENQY3prZTF6RjV5c2pIV19JYUJadE53QS14UEgwZFJRWFdkcDhpNl9xZnNHU3hCQ214YzFJOEhsRTNuMEdFb3FhbXNFbmNxS2dXMm1tV2FkUU5hQVFOMWxkY1Y4dmJvUnlSZzVpUElSQUtrRk5KYmlGNTByRmFjVnlQTFVtdVIyWnQzNnFpRVpVMUxwTnp4RVdnX1pDcUhuUzlzR3BSbmJCaTVRZkZlenZYc3JzS0JQRThPZFpvdHgyS0FzUWxjcDBwb3FqTTJ3WWpPclc3YWJma2dwMHdrWFFUODVHcWl4V2Zia3R0eENKelAwR1BNa1dHWHNLUndQbGpLaTFEU0JZektORDJBVjF2N3pIVnowRUVXR0tiUkVZazRtTHZaTzhXUVpaYzhuRS1xendkWGNJRFROR29Tci1yM25ZYTNORkN1Xzh3QnRRU1J5RGsydUlSMC1xRFFiQTJCeGl0dERDaGVjZEpzR1ZKeklvdW01LWRiYmZlbGgwalBmMVRSVlRNM0JvQllub3Y4WHB4Z0VfU0ZsNGx1d1lOWmhubVNfUHBLVnozb2hUcDRTTDI3aUpnY3M1eHI0LUhhaHp4UFFKb0s5ZGZnVVY4bDMta1VvOTRqdkVDeVRRM2F3VXpUcjI1SF8tR0ltZ3kwYVZyS0o0TXFScXUxVlpQWmE5VUs1WWd1a0xDd05xS2tBaVhwX0RQTmVzdXNJS2V0NE9NaElwS1QxeVVSalBEekRPdS0teUZxX0E2QVphaTlxSnZBbnVqaUQzSDA0cDFZWVIwTXVpb3pCQl81TUgtWGFDYmpVU29Mbnh1RXZmemhaRUNtOWYwTjByMDBERWVTX1o0bFVjUWdheE5jWHFjX2hienpUMG5NNUJqSF9CRUFKVTluT0JXU3lBM2Y5UDM5NlBjQ2tOLS13LU9McmFqalpSbXJnYldoVzVVNGxuNnZBYU03VkpqZlFld1hxZmhQX0RSQzBPdFlNeGJQN2xsNld4cXc4NXBVX01Jc2tMS0ZWV0Z5ejZLRTZjTkVxMEszR3pRSE9LdEh3NFhCekNhOWRoNzNteWVSalp4ZldQemctcndDUG5YZUNCZmxaaGFoSWRqdEtjbFNiZUVVbzNGcnRoZjVxOGVJeWhlZmxWTmV1eGhaaEFGV2ZQdzM0YmtaaHJmZF9ndnltNzFybjFzWnoyMWVtc2Y4LUptaEVyNjYwem1CdmhWNG9PUG9ILXM4amRkRkJmSk5ERFpOZi1NRk5PNmNmOUNwa0pSd0Y2bUtFSWM0dEw5MHVQRnpiaDVxa3Y3dUhlc2duN2tDV3BvVjNwM0xJTVY2QnRmdElUVFc2RDBwQTktU3dqQ3V5OVJqV1ZESkZoYWxkWjRIWVhZdDhWc2Q0eHBBdnFKVEZqTnNnUUFLWTQ0QUpZckdMZ1BrNjVsZWpzYXNZOFp5ajFpa3lzOXVEUWlWOU1WMWNXc2xDTE1vVHR0bzRMdC1IaFBrbzlSMjhkR3JMcFZYWHRjV1FnejFtbUI2bHFOTnhKMU5OMS1saHZYbVM4WDBQRk1oTVpBNGJXbW5XU3pTTlZsa21PR2EyTk9FSV9WdXBZRTkyUkQyX053b09GbVdmTkNXTlBObDVXaTFVZGZyUHpyemE5RkpMVm53ckNIdGJJUGtQVFZ0b0dGNlFod19abk9hd0xLTWxSakJmbGk3VnNyalF1U1FaOVVYeGR4eXJaRTBjYWxJcy1tblZ3NGR3a3FGTkVDb0lpOXoyVEZaVkgxQnF2UkhIeG9CeVNnYWMtVHVwS003RXNTS1I3NVpTUTk1dmRZNjR4bE5QUV9aR29EU3J6UWRIVEdpaDdSSkNhY0tJak81NXNtVDdfaDV0Zi1ab3hOYVEzZ1FodUF1N21UVEQ5RjRueDROb3BBenVLZERfdVNVOFlGbTRVUEtialZNQkcwZV9lZ3BzX3RBOWdLLWRiY1FRX1RHWlJOMGhXXzF2SERCelVpZVRNN1Vodlp5ZU4xeGlPczd4Qk5Rd282NTBsTjdkU2VGal9FTy1xc3hPMnBZbEdBQ2xxaTJoYkV2VmEyS25JZnNIVTFnUWM3dmlsRloyRmw2eHNhbmF1Q3pzNkhWVEd1UWFKTG5peEtvX0xxc0xjSVhtQUFZU1ppdWlNQ002TXVjSXg4dVhHVldZTGFlZW1QM296YjYyWHJSMExhMWxndVI5OVF3)
      flutter: stable
      xcode: 14.2
      cocoapods: default
    scripts:
      - |
        # set up key.properties
        echo $FCI_KEYSTORE | base64 --decode > $FCI_KEYSTORE_PATH
        cat >> "$FCI_BUILD_DIR/android/key.properties" <<EOF
        storePassword=$FCI_KEYSTORE_PASSWORD
        keyPassword=$FCI_KEY_PASSWORD
        keyAlias=$FCI_KEY_ALIAS
        storeFile=/tmp/keystore.keystore
        EOF
      - |
        # set up local properties
        echo "flutter.sdk=$HOME/programs/flutter" > "$FCI_BUILD_DIR/android/local.properties"
      - |
        cd ..
        git clone --single-branch --branch task/dart3 https://bitbucket.org/mtminc/mbl-flutter-packages.git
      - flutter packages pub get
      - unset ANDROID_NDK_HOME
      - flutter build apk --release --flavor qa -t lib/main_qa.dart --build-number $PROJECT_BUILD_NUMBER
      - find . -name "Podfile" -execdir pod install \;
      - keychain initialize
      - app-store-connect fetch-signing-files "net.mtmlink.member.qa" --type IOS_APP_ADHOC
        --create
      - keychain add-certificates
      - flutter build ios --release --flavor qa -t lib/main_qa.dart --build-number $PROJECT_BUILD_NUMBER --no-codesign
      - xcode-project use-profiles
      - xcode-project build-ipa --workspace "ios/Runner.xcworkspace" --scheme "qa"
    artifacts:
      - build/**/outputs/apk/**/*.apk
      - build/**/outputs/bundle/**/*.aab
      - build/**/outputs/**/mapping.txt
      - build/ios/ipa/*.ipa
      - /tmp/xcodebuild_logs/*.log
      - flutter_drive.log
    publishing:
      email:
        recipients:
          -  psonawane@mtm-inc.net
      firebase:
        firebase_token: 1//04NoI40pTk9fACgYIARAAGAQSNwF-L9Ir_A24cX5IzUuG4Xt-ucf6hs-ic5GI5IO36utGC-P7L32WPgWfIhu0xDyTs7FgCk05sjc
        ios:
          app_id: 1:743002394753:ios:53208ceb18b5c1a3a57d80
          groups:
            - member-ios
            - dev
        android:
          app_id: 1:743002394753:android:332f5528d4e3448ea57d80
          groups:
            - member-android
            - dev
  post-push-testing:
    name: Post Push Testing
    instance_type: mac_pro
    max_build_duration: 60
    environment:
      vars:
        GIT_COMMIT_COUNT: '1'
      flutter: stable
      xcode: 14.2
      cocoapods: default
    triggering:
      events:
        - push
      branch_patterns:
        - pattern: '*feature/*'
          include: true
          source: true
      tag_patterns:
        - pattern: '*'
          include: true
    scripts:
      - |
        cd ..
        git clone --single-branch --branch task/dart3 https://bitbucket.org/mtminc/mbl-flutter-packages.git
      - flutter packages pub get
      - flutter analyze
    artifacts:
      - flutter_drive.log
    publishing:
      email:
        recipients:
          -  psonawane@mtm-inc.net
       
 